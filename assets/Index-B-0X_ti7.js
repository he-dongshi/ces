import{d as M,o as P,m as C,r,A as p,a as s,z as T,c as G,b as V,e as f,g as t,h as a,B as R,k as c,j as S,F as W,y as q,_ as H}from"./index-BUVdxLJQ.js";const J={class:"page p10"},K={class:"between mb10"},O={class:"actions"},Q=M({__name:"Index",setup(X){P(()=>{u(),D()}),C({role_name:""}),r(0),r([]);const i=C({pager:{page:1,limit:15},total:0,list:[]}),v=r(!1),u=()=>{v.value=!0,p.postList(i.pager).then(l=>{i.list=l.data,i.total=l.total,v.value=!1})},b=r([]),y=()=>{p.getNumber({model_str:"GW"}).then(l=>{o.value.number=l.data,h()})},w=l=>{p.postDetail(l).then(e=>{o.value.permissions=e.data.roles.permissions.map(d=>d.id)})},D=()=>{p.authList().then(l=>{b.value=l.data})},m=r(!1),g=r(""),o=r({}),k=l=>{g.value=l?"修改岗位":"新增岗位",o.value=l?{...l}:{number:"",name:"",permissions:[]},console.log(o.value),l&&w(l.id),m.value=!0},B=()=>{y()},h=()=>{g.value=="新增岗位"?p.postAdd(o.value).then(()=>{u(),m.value=!1}):p.postEdit(o.value.id,o.value).then(()=>{u(),m.value=!1})},L=l=>{q.confirm("确定删除这个岗位吗").then(()=>{p.postDel(l.id).then(()=>{u()})})};return(l,e)=>{const d=s("el-button"),_=s("el-table-column"),N=s("el-table"),U=s("el-pagination"),z=s("el-card"),A=s("el-input"),x=s("el-form-item"),E=s("el-tree-select"),I=s("el-form"),$=s("el-dialog"),j=T("loading");return V(),G(W,null,[f("div",J,[t(z,{shadow:"never"},{default:a(()=>[f("div",K,[f("div",O,[t(d,{type:"primary",onClick:e[0]||(e[0]=n=>k(null))},{default:a(()=>e[5]||(e[5]=[c("新增")])),_:1}),t(d,{onClick:u},{default:a(()=>e[6]||(e[6]=[c("刷新")])),_:1})])]),R((V(),S(N,{data:i.list,border:"",stripe:""},{default:a(()=>[t(_,{label:"名称",prop:"name"}),t(_,{label:"编号",prop:"number"}),t(_,{label:"创建时间",prop:"created_at"}),t(_,{label:"更新时间",prop:"updated_at"}),t(_,{label:"操作",width:"160"},{default:a(({row:n})=>[t(d,{type:"primary",link:"",onClick:F=>k(n)},{default:a(()=>e[7]||(e[7]=[c("修改")])),_:2},1032,["onClick"]),t(d,{type:"danger",link:"",onClick:F=>L(n)},{default:a(()=>e[8]||(e[8]=[c("删除")])),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"])),[[j,v.value]]),t(U,{class:"mt10",background:"",layout:"prev, pager, next,jumper","current-page":i.pager.page,"onUpdate:currentPage":e[1]||(e[1]=n=>i.pager.page=n),"page-size":i.pager.limit,total:i.total,onCurrentChange:u},null,8,["current-page","page-size","total"])]),_:1})]),t($,{title:g.value,modelValue:m.value,"onUpdate:modelValue":e[4]||(e[4]=n=>m.value=n),width:"600px"},{footer:a(()=>[t(d,{type:"primary",onClick:B},{default:a(()=>e[9]||(e[9]=[c("提交")])),_:1})]),default:a(()=>[t(I,{class:"p10","label-width":"100px"},{default:a(()=>[t(x,{label:"名称"},{default:a(()=>[t(A,{modelValue:o.value.name,"onUpdate:modelValue":e[2]||(e[2]=n=>o.value.name=n),placeholder:"请输入名称"},null,8,["modelValue"])]),_:1}),t(x,{label:"角色权限"},{default:a(()=>[t(E,{modelValue:o.value.permissions,"onUpdate:modelValue":e[3]||(e[3]=n=>o.value.permissions=n),data:b.value,"node-key":"id",props:{label:"permission_name",value:"id"},multiple:"","show-checkbox":"",label:"permission_name"},null,8,["modelValue","data"])]),_:1})]),_:1})]),_:1},8,["title","modelValue"])],64)}}}),Z=H(Q,[["__scopeId","data-v-5d96d88e"]]);export{Z as default};
