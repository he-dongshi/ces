import{d as z,o as K,m as q,r as m,A as y,l as G,a as s,z as H,c as U,b as c,e as C,g as l,h as a,B as J,k as p,j as x,D as O,F as B,i as Q,_ as R}from"./index-BUVdxLJQ.js";const S={class:"page p10"},W={class:"between mb10"},X={class:"actions"},Y=z({__name:"Index",setup(Z){K(()=>{_()});const V=q({permission_name:"",sortField:"sort",order:"asc"}),L=m(0),k=m(!1),g=m([]),_=()=>{k.value=!0,y.menuList(V).then(u=>{g.value=u.data,L.value=u.total,k.value=!1})},D=u=>{const e=[],d=n=>{n.forEach(r=>{e.push(r),r.children&&r.children.length>0&&d(r.children)})};return d(u),e},I=G(()=>{if(!o.value.id)return[];const u=D(g.value),e=u.find(n=>n.id===o.value.id);if(!e)return[];const d=e.parent_id;return u.filter(n=>n.parent_id===d&&n.id!==o.value.id)}),v=m(!1),f=m(""),o=m({}),w=(u,e)=>{f.value=u?"修改菜单":"新增菜单",u?o.value={...u}:o.value={parent_id:e||0,route:"",redirect:"",permission_name:"",type:1},v.value=!0},N=()=>{f.value=="新增菜单"?y.menuAdd(o.value).then(()=>{_(),v.value=!1}):y.menuEdit(o.value.id,o.value).then(()=>{_(),v.value=!1})};return(u,e)=>{const d=s("el-button"),n=s("el-input"),r=s("el-col"),A=s("el-row"),b=s("el-table-column"),E=s("el-table"),F=s("el-card"),M=s("el-option"),T=s("el-select"),i=s("el-form-item"),$=s("el-form"),P=s("el-dialog"),h=H("loading");return c(),U(B,null,[C("div",S,[l(F,{shadow:"never"},{default:a(()=>[C("div",W,[C("div",X,[l(d,{type:"primary",onClick:e[0]||(e[0]=t=>w(null))},{default:a(()=>e[9]||(e[9]=[p("新增")])),_:1}),l(d,{onClick:_},{default:a(()=>e[10]||(e[10]=[p("刷新")])),_:1})]),l(A,{gutter:20},{default:a(()=>[l(r,{class:"mb10",xs:24,sm:8,md:6,lg:4,xl:3},{default:a(()=>[l(n,{class:"ml10",placeholder:"菜单名称",modelValue:V.permission_name,"onUpdate:modelValue":e[1]||(e[1]=t=>V.permission_name=t)},{append:a(()=>[l(d,{onClick:_},{default:a(()=>e[11]||(e[11]=[p("搜索")])),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1})]),J((c(),x(E,{data:g.value,border:"",stripe:"","row-key":"id"},{default:a(()=>[l(b,{label:"菜单名称",prop:"permission_name"}),l(b,{label:"菜单路由",prop:"route",width:"170"}),l(b,{label:"创建时间",prop:"created_at"}),l(b,{label:"操作",width:"120",align:"center"},{default:a(({row:t})=>[l(d,{type:"success",link:"",onClick:j=>w(null,t.id)},{default:a(()=>e[12]||(e[12]=[p("新增")])),_:2},1032,["onClick"]),l(d,{type:"primary",link:"",onClick:j=>w(t)},{default:a(()=>e[13]||(e[13]=[p("修改")])),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"])),[[h,k.value]])]),_:1})]),l(P,{title:f.value,modelValue:v.value,"onUpdate:modelValue":e[8]||(e[8]=t=>v.value=t),width:"600px"},{footer:a(()=>[l(d,{type:"primary",onClick:N},{default:a(()=>e[14]||(e[14]=[p("提交")])),_:1})]),default:a(()=>[l($,{class:"p10","label-width":"100px"},{default:a(()=>[f.value==="修改菜单"?(c(),x(i,{key:0,label:"父级菜单"},{default:a(()=>[l(T,{modelValue:o.value.parent_id,"onUpdate:modelValue":e[2]||(e[2]=t=>o.value.parent_id=t),placeholder:"请选择或输入父级菜单",clearable:"",filterable:"","allow-create":"","default-first-option":"","reserve-keyword":!1},{default:a(()=>[(c(!0),U(B,null,Q(I.value,t=>(c(),x(M,{key:t.id,label:t.permission_name,value:t.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})):O("",!0),l(i,{label:"菜单名称:"},{default:a(()=>[l(n,{modelValue:o.value.permission_name,"onUpdate:modelValue":e[3]||(e[3]=t=>o.value.permission_name=t),placeholder:"请输入菜单名称"},null,8,["modelValue"])]),_:1}),l(i,{label:"Path"},{default:a(()=>[l(n,{modelValue:o.value.route,"onUpdate:modelValue":e[4]||(e[4]=t=>o.value.route=t),placeholder:"请输入菜单路由path"},null,8,["modelValue"])]),_:1}),l(i,{label:"Key:"},{default:a(()=>[l(n,{modelValue:o.value.module,"onUpdate:modelValue":e[5]||(e[5]=t=>o.value.module=t),placeholder:"请输入路由name"},null,8,["modelValue"])]),_:1}),l(i,{label:"重定向:"},{default:a(()=>[l(n,{modelValue:o.value.redirect,"onUpdate:modelValue":e[6]||(e[6]=t=>o.value.redirect=t),placeholder:"请输入路由redirect"},null,8,["modelValue"])]),_:1}),l(i,{label:"排序:"},{default:a(()=>[l(n,{modelValue:o.value.sort,"onUpdate:modelValue":e[7]||(e[7]=t=>o.value.sort=t),placeholder:"请输入序号"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1},8,["title","modelValue"])],64)}}}),le=R(Y,[["__scopeId","data-v-eb8449af"]]);export{le as default};
